<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../custom_components/ace-editor.html">
<link rel="import" href="../custom_components/html-editor.html">
<link rel="import" href="../custom_components/image-editor.html">

<dom-module id="file-editor">
    <template>
        <div id="editorContainer">
        </div>
        <div>
            <button on-click="save">Save</button>
            <button on-click="close">Close</button>
        </div>
    </template>
</dom-module>

<script>
    Polymer({
        is: 'file-editor',

        properties: {
            fileData: {
                type: String,
                observer: '_fileDataChanged'
            },

            contentType: {
                type: String,
                observer: '_contentTypeChanged'
            },

            savedFileData: {
                type: String,
                readOnly: true,
                notify: true
            }
        } ,

        ready: function() {
        },

        _fileDataChanged: function(data) {
            if (this.editorElement) {
                this.editorElement.fileData = data;
            }
        },

        _contentTypeChanged: function(type) {
            var editorType = this.editorTypes[type] || "ace-editor";
            var editorElement = this.editorElement = document.createElement(editorType);
            editorElement.id = "editor";
            this.$.editorContainer.appendChild(editorElement);
            editorElement.fileData = this.fileData;
            editorElement.contentType = type;
        },

        save: function() {
            console.log('Save');
            this._setSavedFileData(this.editorElement.getFileData());
        },

        close: function() {
            console.log('Close');

        },

        editorTypes: {
            "text/html": "html-editor",
            "image/jpeg": "image-editor"
        }

    });
</script>
