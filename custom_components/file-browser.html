<link rel="import" href="../bower_components/polymer/polymer.html">

<link href="../bower_components/ag-grid/dist/ag-grid.css" rel="stylesheet">
<link href="../bower_components/ag-grid/dist/theme-fresh.css" rel="stylesheet">
<script src="../bower_components/ag-grid/dist/ag-grid.js"></script>


<dom-module id="file-browser">
    <template>
        <h1>File browser</h1>
        <ag-grid id="grid" class="ag-file-browser"></ag-grid>
    </template>
</dom-module>

<script>
    Polymer({
        is: 'file-browser',

        properties: {
            fileTree: {
                type: Array,
                observer: '_fileTreeChanged'
            }
        },

        _fileTreeChanged: function (fileTree) {
            this.$.grid.api.setRowData(fileTree)
        },

        ready: function() {
            console.log('file-browser ready');

            function innerCellRenderer(params) {
                var image;
                if (params.node.group) {
                    image = params.node.level === 0 ? 'disk' : 'folder';
                } else {
                    image = 'file';
                }
                var imageFullUrl = '../../bower_components/ag-grid/dist/' + image + '.png';
                return '<img src="'+imageFullUrl+'" style="padding-left: 4px;" /> ' + params.data.name;
            }

            function sizeCellStyle() {
                return {'text-align': 'right'};
            }

            var columnDefs = [
                {headerName: "Name", field: "name", width: 250,
                    cellRenderer: {
                        renderer: 'group',
                        innerRenderer: innerCellRenderer
                    }},
                {headerName: "Size", field: "size", width: 70, cellStyle: sizeCellStyle},
                {headerName: "Type", field: "type", width: 150},
                {headerName: "Date Modified", field: "dateModified", width: 150}
            ];

            var gridOptions = {
                columnDefs: columnDefs,
                rowData: this.fileTree,
                rowSelection: 'multiple',
                rowsAlreadyGrouped: true,
                enableColResize: true,
                enableSorting: true,
                rowHeight: 20,
                icons: {
                    groupExpanded: '<i class="fa fa-minus-square-o"/>',
                    groupContracted: '<i class="fa fa-plus-square-o"/>'
                }
//                onRowClicked: rowClicked
            };

            this.$.grid.setGridOptions(gridOptions);

        }

    });


</script>
